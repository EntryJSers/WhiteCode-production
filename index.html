<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
    <title>WhiteCode</title>
    <link href="./lib/entry-js/dist/entry.css" rel="stylesheet" />
    <link href="https://playentry.org/lib/entry-tool/dist/entry-tool.css" rel="stylesheet" />
    <link href="https://playentry.org/lib/entry-lms/dist/assets/app.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">
    <meta property="og:url" content="https://code.thoratica.tech" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="WhiteCode" />
    <meta property="og:description" content="entryjs 기반의 블록 코딩 사이트" />
    <meta property="og:image" content="https://i.imgur.com/K7eGH4f.png" />
    <style>
        .entryScene,
        #workspace,
        .entryPlayground,
        #entryCategoryTab,
        .entryCategoryListWorkspace,
        .blockMenuContainer,
        .entryContainerListWorkspace,
        .entryContainerListElementWorkspace {
            background-color: whitesmoke;
        }

        .entryBoard,
        .selectedObject,
        .entryObjectRotationWrapperWorkspace {
            background-color: white !important;
        }
    </style>
</head>

<body>
    <div class="ui menu" style="margin: 0 !important; height: 5%;">
        <div class="ui item">WhiteCode</div>
        <div class="ui item">
            <div class="ui input">
                <input id="title" placeholder="작품명을 입력하세요">
            </div>
        </div>
        <div class="ui item">
            <button id="save" class="ui primary button">저장</button>
        </div>
        <div class="ui item">
            <button class="ui green button" onclick="changeWorkspaceMode('block')">블록</button>
        </div>
        <div class="ui item">
            <button class="ui yellow button" onclick="changeWorkspaceMode('python')">파이썬</button>
        </div>
        <div id="download_button" class="ui item">
            <a id="download" class="ui primary button" download="project.wcp">PC에 저장</a>
        </div>
    </div>




    <div id="workspace" style="height: 95%;"></div>

    <!--language-->
    <script src="./lib/entry-js/extern/lang/ko.js"></script>

    <script type="text/javascript" src="https://playentry.org/lib/PreloadJS/lib/preloadjs-0.6.0.min.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/EaselJS/lib/easeljs-0.8.0.min.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/SoundJS/lib/soundjs-0.6.0.min.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/SoundJS/lib/flashaudioplugin-0.6.0.min.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/lodash/dist/lodash.min.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/jquery-ui/ui/minified/jquery-ui.min.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/velocity/velocity.min.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/codemirror/lib/codemirror.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/codemirror/addon/hint/show-hint.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/codemirror/addon/lint/lint.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/codemirror/addon/selection/active-line.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/codemirror/mode/javascript/javascript.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/codemirror/addon/hint/javascript-hint.js"></script>
    <script type="text/javascript" src="https://playentry.org/js/jshint.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/fuzzy/lib/fuzzy.js"></script>
    <script type="text/javascript" src="https://playentry.org/js/textmode/python/python.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/entry-js/extern/util/filbert.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/entry-js/extern/util/CanvasInput.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/entry-js/extern/util/ndgmr.Collision.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/entry-js/extern/util/handle.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/entry-js/extern/util/bignumber.min.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/socket.io-client/socket.io.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/react/react.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/react/react-dom.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/entry-lms/dist/assets/app.js"></script>
    <script type="text/javascript"
        src="https://playentry.org/lib/literallycanvas-mobile/lib/js/literallycanvas.js"></script>
    <script type="text/javascript" src="https://playentry.org/lib/entry-tool/dist/entry-tool.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>

    <script src="./lib/entry-js/extern/util/static.js"></script>
    <script src="./lib/entry-js/dist/entry.js"></script>
    <script src="./lib/entry-js/dist/0.js"></script>

    <script>
        (function () {
            var textFile = null,
                makeTextFile = function (text) {
                    var data = new Blob([text], { type: 'text/plain' });
                    // If we are replacing a previously generated file we need to
                    // manually revoke the object URL to avoid memory leaks.
                    if (textFile !== null) {
                        window.URL.revokeObjectURL(textFile);
                    }
                    textFile = window.URL.createObjectURL(data);
                    return textFile;
                };
            document.getElementById('download').addEventListener('click', function () {
                $('#download_button').html(`<a id="download" class="ui primary button" download="${$('#title').val()}.wcp">PC에 저장</a>`);
                var link = document.getElementById('download');
                link.href = makeTextFile(JSON.stringify(Entry.exportProject()));
            }, false);
        })();
    </script>
    <script>
        function changeWorkspaceMode(mode) {
            const option = {};

            if (mode === 'block') {
                option.boardType = Entry.Workspace.MODE_BOARD;
                option.textType = -1;
            } else {
                option.boardType = Entry.Workspace.MODE_VIMBOARD;
                option.textType = Entry.Vim.TEXT_TYPE_PY;
                option.runType = Entry.Vim.WORKSPACE_MODE;
            }

            const workspace = Entry.getMainWS();

            if (workspace) {
                workspace.setMode(option);
            } else {
                console.error('entry workspace not found!');
            }
        };
    </script>
    <!--main script-->
    <script>
        window.PUBLIC_PATH_FOR_ENTRYJS = '/lib/entry-js/dist/';
        $(document).ready(function () {
            var initOption = {
                type: 'workspace',
                textCodingEnable: true,
            };
            Entry.init(document.getElementById('workspace'), initOption);
            Entry.loadProject();
        });
    </script>
</body>

</html>
